Author: 
  Alex Conley (alexander.conley@colorado.edu)
with contributions by Michael Wood-Vasey.
Matrix code taken from the TNT by Roldan Pozo.
